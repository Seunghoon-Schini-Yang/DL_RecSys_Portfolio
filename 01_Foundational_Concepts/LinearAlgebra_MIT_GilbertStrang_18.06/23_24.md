# ðŸ“š Lecture 23: Differential equations and exp(At)

**â—‹ Differential Equations**

For time variable $t$,

```math
\begin{align}
\text{For}\quad \vec{u}(t) = \begin{bmatrix} u_{1}(t) \\ u_{2}(t) \end{bmatrix} \quad\text{,}\quad \vec{u}(0) = \begin{bmatrix} u_{1}(0) \\ u_{2}(0) \end{bmatrix} \quad\text{(Initial Condition)}\\
\text{â†’ Solve Differential Equation}\quad \frac{d\vec{u}}{dt} = A\vec{u} \quad\text{for}\quad A = \begin{bmatrix} a_{11} & a_{12} \\ a_{21} & a_{22} \end{bmatrix}
\end{align}
```

```math
\begin{align}
\text{Solution :}\quad \vec{u}(t) {} &= c_{1}e^{\lambda_{1}t}\vec{v}_{1} + c_{2}e^{\lambda_{2}t}\vec{v}_{2} \\\\
&= S \begin{bmatrix} c_{1}e^{\lambda_{1}t} \\ c_{2}e^{\lambda_{2}t} \end{bmatrix} \quad(\therefore\: \vec{c}(0) = \begin{bmatrix} c_{1} \\ c_{2} \end{bmatrix}) \\\\
&= S\vec{c}(t)
\end{align}
```

```math
\vec{u}(0) = S\vec{c}(0) \quad\rightarrow\quad
\therefore\: \vec{c}(0) = \begin{bmatrix} c_{1} \\ c_{2} \end{bmatrix} = S^{-1}\vec{u}(0)
```
<br><br>

```math
\begin{align}
\frac{d^{k}\vec{u}}{dt^{k}} = A^{k}\vec{u}(t) {} &= S\Lambda^{k}S^{-1}\vec{u}(t) \\
&= S\Lambda^{k}(S^{-1}S)\vec{c}(t) \\\\
&= S\Lambda^{k}\vec{c}(t)
\end{align}
```
<br><br>

Example)

```math
\begin{align}
\text{For}\quad \vec{u}(t) \quad\text{and}\quad \vec{u}(0) = \begin{bmatrix} 1 \\ 0 \end{bmatrix} \quad, \\

\frac{d\vec{u}}{dt} = \begin{bmatrix} \frac{du_{1}}{dt} \\ \frac{du_{2}}{dt} \end{bmatrix} = \begin{bmatrix} -u_{1} + 2u_{2} \\ u_{1} - 2u_{2} \end{bmatrix} = \begin{bmatrix} -1 & 2 \\ 1 & -2 \end{bmatrix} \begin{bmatrix} u_{1} \\ u_{2} \end{bmatrix} = A\vec{u}
\end{align}
```

```math
\begin{align}
{} & \text{Eigenvalues of}\: A \: \text{:}\quad\begin{cases}
\lambda_{1} = 0 \quad(\because A \: \text{is singular}) \\
\lambda_{2} = -3 \quad(\because tr(A) = \lambda_{1} + \lambda_{2} = -3)
\end{cases} \\
& \text{Eigenvectors of}\: A \: \text{:}\quad\begin{cases}
(\lambda_{1},\vec{v}_{1}) = (0,\begin{bmatrix} 2 \\ 1 \end{bmatrix}) \\
(\lambda_{2},\vec{v}_{2}) = (-3,\begin{bmatrix} 1 \\ -1 \end{bmatrix}) \end{cases}
\end{align}
```

```math
\begin{align}
S = \begin{bmatrix} 2 & 1 \\ 1 & -1 \end{bmatrix} \quad\rightarrow\quad S^{-1} = \begin{bmatrix} \frac{1}{3} & \frac{1}{3} \\ \frac{1}{3} & -\frac{2}{3} \end{bmatrix} \\\\
\vec{c}(0) = \begin{bmatrix} c_{1} \\ c_{2} \end{bmatrix} = S^{-1}\vec{u}(0) = \begin{bmatrix} \frac{1}{3} & \frac{1}{3} \\ \frac{1}{3} & -\frac{2}{3} \end{bmatrix} \begin{bmatrix} 1 \\ 0 \end{bmatrix} = \begin{bmatrix} \frac{1}{3} \\ \frac{1}{3} \end{bmatrix}
\end{align}
```

```math
\begin{align}
\text{Solution :}\quad \vec{u}(t) {} &= c_{1}e^{\lambda_{1}t}\vec{v}_{1} + c_{2}e^{\lambda_{2}t}\vec{v}_{2} \\
&= \frac{1}{3}e^{0t}\begin{bmatrix} 2 \\ 1 \end{bmatrix} + \frac{1}{3}e^{-3t}\begin{bmatrix} 1 \\ -1 \end{bmatrix} \\
&= \frac{1}{3}\begin{bmatrix} 2 \\ 1 \end{bmatrix} + \frac{1}{3}e^{-3t}\begin{bmatrix} 1 \\ -1 \end{bmatrix}
\end{align}
```
<br>

```math
\begin{align}
\text{For}\quad \vec{u}(t) = \frac{1}{3}\begin{bmatrix} 2 \\ 1 \end{bmatrix} + \frac{1}{3}e^{-3t}\begin{bmatrix} 1 \\ -1 \end{bmatrix}\: , \\
\text{as}\quad t\to\infty \quad\text{then}\: \lim_{k\to\infty} \vec{u}(t) \approx \frac{1}{3}\begin{bmatrix} 2 \\ 1 \end{bmatrix} \quad\text{(Steady State)}
\end{align}
```
<br>

As $t\to\infty$,<br>
â‘  Stability $(\vec{u}(t) \to 0)$<br>
$\quad$ Condition : All $\Re(\lambda) < 0 \quad(\leftrightarrow tr(A) = \lambda_{1}+\lambda_{2} < 0$ and $det(A) = \lambda_{1}\lambda_{2} > 0)$<br>
â‘¡ Steady State $(\vec{u}(t) \to const.)$<br>
$\quad$ Condition : $\lambda_{1} = 0$ and $\Re(\lambda_{2}) < 0$<br>
â‘¢ Blow up if any $\Re(\lambda) > 0$<br>
<br><br>

**â—‹ Matrix Exponential** <a href="https://en.wikipedia.org/wiki/Matrix_exponential">(Wikipedia)</a>

- Taylor Series
```math
f(x) = f(a) + \frac{f'(a)}{1!}(x-a) + \frac{f''(a)}{2!}(x-a)^{2} + \cdots = \sum_{n=0}^{\infty} \frac{f^{(n)}(a)}{n!}(x-a)^{n}
```

- Maclaurin Series ( : Taylor Series with $a = 0$)
```math
f(x) = f(0) + \frac{f'(0)}{1!}x + \frac{f''(0)}{2!}x^{2} + \cdots = \sum_{n=0}^{\infty} \frac{f^{(n)}(0)}{n!}x^{n}
```

- $e^{\Lambda t}$ : the Exponential of $(n \times n)$ matrix $\Lambda t$<br>

```math
\begin{align}
\text{From Maclaurin Series of}\quad e^{x} = 1 + \frac{x}{1!} + \frac{x^{2}}{2!} + \cdots = \sum_{k=0}^{\infty} \frac{x^{k}}{k!}
\end{align}
```

```math
\begin{align}
e^{\Lambda t} {} &= I + \frac{\Lambda t}{1!} + \frac{(\Lambda t)^{2}}{2!} + \cdots = \sum_{n=0}^{\infty} \frac{(\Lambda t)^{n}}{n!} \\
&= \begin{bmatrix}
1 & \cdots & 0 \\
\vdots & \ddots & \vdots \\
0 & \cdots & 1
\end{bmatrix} + \frac{t}{1!}\begin{bmatrix}
\lambda_{1} & \cdots & 0 \\
\vdots & \ddots & \vdots \\
0 & \cdots & \lambda_{n}
\end{bmatrix} + \frac{t^{2}}{2!}\begin{bmatrix}
\lambda^{2}_{1} & \cdots & 0 \\
\vdots & \ddots & \vdots \\
0 & \cdots & \lambda^{2}_{n}
\end{bmatrix} + \cdots \\
&= \begin{bmatrix}
(1 + \frac{\lambda_{1}t}{1!} + \frac{(\lambda_{1}t)^{2}}{2!} + \cdots) & \cdots & 0 \\
\vdots & \ddots & \vdots \\
0 & \cdots & (1 + \frac{\lambda_{n}t}{1!} + \frac{(\lambda_{n}t)^{2}}{2!} + \cdots)
\end{bmatrix} \\
&= \begin{bmatrix}
\sum_{k=0}^{\infty} \frac{(\lambda_{1}t)^{k}}{k!} & \cdots & 0 \\
\vdots & \ddots & \vdots \\
0 & \cdots & \sum_{k=0}^{\infty} \frac{(\lambda_{n}t)^{k}}{k!}
\end{bmatrix} \\
&= \begin{bmatrix}
e^{\lambda_{1}t} & \cdots & 0 \\
\vdots & \ddots & \vdots \\
0 & \cdots & e^{\lambda_{n}t}
\end{bmatrix}
\end{align}
```
<br>

- $e^{At}$<br>
```math
\begin{align}
e^{At} {} &= I + \frac{At}{1!} + \frac{(At)^{2}}{2!} + \cdots \\
&= SIS^{-1} + \frac{S(\Lambda t)S^{-1}}{1!} + \frac{S(\Lambda t)^{2}S^{-1}}{2!} + \cdots \\
&= S (I + \frac{\Lambda t}{1!} + \frac{(\Lambda t)^{2}}{2!} + \cdots) S^{-1} \\
&= S (\sum_{n=0}^{\infty} \frac{(\Lambda t)^{n}}{n!}) S^{-1} \\\\
&= Se^{\Lambda t}S^{-1}
\end{align}
```
<br>

- $\vec{u}(t)$, $\vec{w}(t)$ expressed by $e^{At}$, $e^{\Lambda t}$

```math
\begin{align}
\text{From}\quad \vec{u}(t) \quad=\quad c_{1}e^{\lambda_{1}t}\vec{v}_{1} + \cdots + c_{n}e^{\lambda_{n}t}\vec{v}_{n} \quad=\quad \begin{bmatrix} \vec{v}_{1} & \cdots & \vec{v}_{n} \end{bmatrix} \begin{bmatrix} c_{1}e^{\lambda_{1}t} \\ \vdots \\ c_{n}e^{\lambda_{n}t} \end{bmatrix} \\
\text{Set}\quad \vec{w}(t) = \begin{bmatrix} c_{1}e^{\lambda_{1}t} \\ \vdots \\ c_{n}e^{\lambda_{n}t} \end{bmatrix} = \begin{bmatrix} e^{\lambda_{1}t} & \cdots & 0 \\
\vdots & \ddots & \vdots \\
0 & \cdots & e^{\lambda_{n}t} \end{bmatrix}
\begin{bmatrix} c_{1} \\ \vdots \\ c_{n} \end{bmatrix} = e^{\Lambda t}\vec{w}(0) \\\\
\text{then}\quad \vec{u}(t) = S\vec{w}(t) = Se^{\Lambda t}\vec{w}(0) = Se^{\Lambda t}S^{-1}\vec{u}(0) = e^{At}\vec{u}(0)
\end{align}
```
<br>

- Derivatives of $\vec{u}(t)$, $\vec{w}(t)$

```math
\begin{align}
\frac{d\vec{u}(t)}{dt} = A\vec{u}(t) \quad\leftrightarrow\quad \frac{d(S\vec{w}(t))}{dt} = S\frac{d\vec{w}(t)}{dt} = AS\vec{w}(t) \\\\

\therefore\quad \frac{d\vec{w}(t)}{dt} \quad=\quad
\begin{cases}
S^{-1}AS\vec{w}(t) \\\\
\begin{bmatrix}
\lambda_{1}c_{1}e^{\lambda_{1}t} \\ \vdots \\ \lambda_{n}c_{n}e^{\lambda_{n}t} \end{bmatrix}
= \begin{bmatrix}
\lambda_{1} & \cdots & 0 \\
\vdots & \ddots & \vdots \\
0 & \cdots & \lambda_{n} \end{bmatrix}
\begin{bmatrix} c_{1}e^{\lambda_{1}t} \\ \vdots \\ c_{n}e^{\lambda_{n}t} \end{bmatrix}
\end{cases} \quad=\quad \Lambda\vec{w}(t)
\end{align}
```
<br>

**â—‹ Gemetric Series**

```math
\begin{align}
(1-x)^{-1} {} &\quad=\quad 1 + x + x^{2} + \cdots \quad=\quad \sum_{k=0}^{\infty}x^{k} \quad(\text{for}\: |x| < 1) \\\\
(I-At)^{-1} &\quad=\quad I + At + (At)^{2} + \cdots \quad=\quad \sum_{k=0}^{\infty}(At)^{k} \quad=\quad S(\sum_{k=0}^{\infty}(\Lambda t)^{k})S^{-1} \\
&\quad=\quad S(I-\Lambda t)^{-1}S^{-1}
\end{align}
```
<br>

For stability $\vec{u}(t) \to 0$ as $t\to\infty$,<br>
All $|\lambda|$ of $At$ must be smaller than $1$. $\quad(|\lambda| < 1)$
<br><br>

<p align="center">
    <img src="images/lecture_23_01.jpg" alt="img_23_01" width="500">
</p><br><br>

**â—‹ Solution of $n$-th order one linear equation (homogeneous)**

- $2$-nd order one linear equation

```math
\begin{align}
\text{For}\quad y''+by'+ky = 0 \quad\text{and}\quad \vec{u}(t) = \begin{bmatrix} y' \\ y \end{bmatrix} \quad, \\
\frac{d\vec{u}(t)}{dt} = \begin{bmatrix} y'' \\ y' \end{bmatrix} = \begin{bmatrix} -b & -k \\ 1 & 0 \end{bmatrix}\begin{bmatrix} y' \\ y \end{bmatrix} = A\vec{u}(t)
\end{align}
```
<br>

- $5$-th order one linear equation

```math
\begin{align}
\text{For}\quad y^{(5)} = a_{11}y^{(4)} + a_{12}y^{(3)} + a_{13}y^{(2)} + a_{14}y^{(1)} + a_{15}y^{(0)} \quad\text{and}\quad \vec{u}(t) = \begin{bmatrix} y^{(4)} \\ y^{(3)} \\ y^{(2)} \\ y^{(1)} \\ y^{(0)} \end{bmatrix} \quad, \\
\frac{d\vec{u}(t)}{dt} = \begin{bmatrix} y^{(5)} \\ y^{(4)} \\ y^{(3)} \\ y^{(2)} \\ y^{(1)} \end{bmatrix} = \begin{bmatrix} a_{11} & a_{12} & a_{13} & a_{14} & a_{15} \\ 1 & 0 & 0 & 0 & 0 \\ 0 & 1 & 0 & 0 & 0 \\ 0 & 0 & 1 & 0 & 0 \\ 0 & 0 & 0 & 1 & 0 \end{bmatrix} \begin{bmatrix} y^{(4)} \\ y^{(3)} \\ y^{(2)} \\ y^{(1)} \\ y^{(0)} \end{bmatrix} = A\vec{u}(t)
\end{align}
```
<br>

- matrix $A$ in $n$-th order one linear equation system

```math
A = \begin{bmatrix}
a_{11} & a_{12} & \cdots & a_{1(n-1)} & a_{1n} \\
1 & 0 & \cdots & 0 & 0 \\
0 & 1 & \cdots & 0 & 0 \\
\vdots & \vdots & \ddots & \vdots & \vdots \\
0 & 0 & \cdots & 1 & 0 \end{bmatrix}
```
